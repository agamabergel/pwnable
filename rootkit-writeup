# change kernel moudle signture using sed | 'rootkit' signture already loaded
$ sed -i 's/rootkit/rootkik/g' rootkit.ko

# move the file locally
$ base64 rootkit.ko
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
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAABHQ0M6IChVYnVudHUvTGluYXJvIDQuNi4zLTF1YnVudHU1KSA0LjYuMwAAR0NDOiAo
VWJ1bnR1L0xpbmFybyA0LjYuMy0xdWJ1bnR1NSkgNC42LjMAAC5zeW10YWIALnN0cnRhYgAuc2hz
dHJ0YWIALm5vdGUuZ251LmJ1aWxkLWlkAC5yZWwudGV4dAAucmVsLmluaXQudGV4dAAuZXhpdC50
ZXh0AC5yb2RhdGEuc3RyMS4xAC5yZWxfX21jb3VudF9sb2MALm1vZGluZm8AX192ZXJzaW9ucwAu
ZGF0YQAucmVsLmdudS5saW5rb25jZS50aGlzX21vZHVsZQAuYnNzAC5jb21tZW50AC5ub3RlLkdO
VS1zdGFjawAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAABwAA
AAIAAAAAAAAANAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAMgAAAAEAAAAGAAAAAAAAAGAAAADQAgAA
AAAAAAAAAAAQAAAAAAAAAC4AAAAJAAAAAAAAAAAAAAAUEAAAiAEAABMAAAACAAAABAAAAAgAAAA8
AAAAAQAAAAYAAAAAAAAAMAMAAOUAAAAAAAAAAAAAAAEAAAAAAAAAOAAAAAkAAAAAAAAAAAAAAJwR
AADQAAAAEwAAAAQAAAAEAAAACAAAAEcAAAABAAAABgAAAAAAAAAVBAAABQAAAAAAAAAAAAAAAQAA
AAAAAABSAAAAAQAAADIAAAAAAAAAGgQAADMAAAAAAAAAAAAAAAEAAAABAAAAZQAAAAEAAAACAAAA
AAAAAFAEAAAkAAAAAAAAAAAAAAAEAAAAAAAAAGEAAAAJAAAAAAAAAAAAAABsEgAASAAAABMAAAAI
AAAABAAAAAgAAAByAAAAAQAAAAIAAAAAAAAAdAQAAFsAAAAAAAAAAAAAAAEAAAAAAAAAewAAAAEA
AAACAAAAAAAAAOAEAAAAAQAAAAAAAAAAAAAgAAAAAAAAAIYAAAABAAAAAwAAAAAAAADgBQAAAAAA
AAAAAAAAAAAABAAAAAAAAACQAAAAAQAAAAMAAAAAAAAA4AUAAIABAAAAAAAAAAAAACAAAAAAAAAA
jAAAAAkAAAAAAAAAAAAAALQSAAAQAAAAEwAAAA0AAAAEAAAACAAAAKoAAAAIAAAAAwAAAAAAAABg
BwAAJAAAAAAAAAAAAAAABAAAAAAAAACvAAAAAQAAADAAAAAAAAAAYAcAAFYAAAAAAAAAAAAAAAEA
AAABAAAAuAAAAAEAAAAAAAAAAAAAALYHAAAAAAAAAAAAAAAAAAABAAAAAAAAABEAAAADAAAAAAAA
AAAAAAC2BwAAyAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAyAsAAMACAAAUAAAA
FAAAAAQAAAAQAAAACQAAAAMAAAAAAAAAAAAAAIgOAACJAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAIAAAAAAAAAAAAAAAAAAwAHAAEAAAAAAAAA5QAAAAIA
BAAMAAAAAAAAAAUAAAACAAYAFwAAAAAAAAAjAAAAAQAKACoAAAAjAAAACQAAAAEACgA7AAAAAAAA
AAABAAABAAsASAAAACwAAAAvAAAAAQAKAAAAAAAAAAAAAAAAAAMAAQAAAAAAAAAAAAAAAAADAAQA
AAAAAAAAAAAAAAAAAwAGAAAAAAAAAAAAAAAAAAMACAAAAAAAAAAAAAAAAAADAAoAAAAAAAAAAAAA
AAAAAwALAAAAAAAAAAAAAAAAAAMADAAAAAAAAAAAAAAAAAADAA0AAAAAAAAAAAAAAAAAAwAPAAAA
AAAAAAAAAAAAAAMAEAAAAAAAAAAAAAAAAAADABEAWAAAACAAAAAEAAAAEQAPAFwAAAAAAAAAgAEA
ABEADQBqAAAAAAAAAAUAAAASAAYAeQAAAAAAAAAEAAAAEQAPAIYAAAAAAAAA5QAAABIABACSAAAA
AAAAAE0AAAASAAIApgAAAAwAAAAEAAAAEQAPAK8AAAAcAAAABAAAABEADwC4AAAA8AEAAFQAAAAS
AAIAygAAABgAAAAEAAAAEQAPANUAAAAAAAAAAAAAABAAAADcAAAAUAIAAE0AAAASAAIA7AAAAAAA
AAAAAAAAEAAAAPMAAAAAAAAAAAAAABAAAAD6AAAAoAAAAFQAAAASAAIADAEAAKACAAAvAAAAEgAC
AA8BAAAQAAAABAAAABEADwAdAQAACAAAAAQAAAARAA8AKAEAAFAAAABGAAAAEgACADoBAACgAQAA
RgAAABIAAgBNAQAAUAEAAE0AAAASAAIAYgEAAAQAAAAEAAAAEQAPAG0BAAAAAQAARgAAABIAAgB9
AQAAFAAAAAQAAAARAA8AAGluaXRtb2R1bGUAZXhpdG1vZHVsZQBfX21vZF9zcmN2ZXJzaW9uMzIA
X19tb2R1bGVfZGVwZW5kcwBfX19fdmVyc2lvbnMAX19tb2RfdmVybWFnaWM1AHNjdABfX3RoaXNf
bW9kdWxlAGNsZWFudXBfbW9kdWxlAHN5c19yZW5hbWVhdABpbml0X21vZHVsZQBzeXNfcmVuYW1l
YXRfaG9va2VkAHN5c19saW5rAHN5c19vcGVuAHN5c19vcGVuYXRfaG9va2VkAHN5c19vcGVuYXQA
c3Ryc3RyAHN5c19vcGVuX2hvb2tlZABtY291bnQAcHJpbnRrAHN5c19saW5rYXRfaG9va2VkAHdw
AHN5c19zeW1saW5rYXQAc3lzX2xpbmthdABzeXNfcmVuYW1lX2hvb2tlZABzeXNfc3ltbGlua19o
b29rZWQAc3lzX3N5bWxpbmthdF9ob29rZWQAc3lzX3JlbmFtZQBzeXNfbGlua19ob29rZWQAc3lz
X3N5bWxpbmsAAAAACAAAAAIgAAANAAAAAQIAABcAAAACHgAAMgAAAAEXAAA/AAAAAQIAAEQAAAAC
IQAAWAAAAAIgAABdAAAAAQIAAGcAAAACHgAAewAAAAEpAACIAAAAAQIAAI0AAAACIQAAqAAAAAIg
AACtAAAAAQIAALcAAAACHgAA2QAAAAElAADmAAAAAQIAAOsAAAACIQAACAEAAAIgAAANAQAAAQIA
ABcBAAACHgAAKwEAAAEaAAA4AQAAAQIAAD0BAAACIQAAWAEAAAIgAABdAQAAAQIAAGcBAAACHgAA
ggEAAAEkAACPAQAAAQIAAJQBAAACIQAAqAEAAAIgAACtAQAAAQIAALcBAAACHgAAywEAAAErAADY
AQAAAQIAAN0BAAACIQAA+AEAAAIgAAD9AQAAAQIAAAcCAAACHgAAKQIAAAEdAAA2AgAAAQIAADsC
AAACIQAAWAIAAAIgAABdAgAAAQIAAGcCAAACHgAAggIAAAEbAACPAgAAAQIAAJQCAAACIQAApAIA
AAIgAAAKAAAAARQAABMAAAABGwAAHQAAAAEdAAAnAAAAASsAADEAAAABJAAAOwAAAAEaAABFAAAA
ASUAAE8AAAABKQAAWQAAAAEXAABgAAAAAiMAAGUAAAABFAAAbAAAAAEfAAB2AAAAARwAAIAAAAAB
JwAAigAAAAEoAACRAAAAASoAAJsAAAABIgAApQAAAAEmAACvAAAAARkAALkAAAACIwAAvgAAAAEV
AADEAAAAARUAANEAAAABFQAA1QAAAAEVAADbAAAAARUAAN8AAAABFQAAAAAAAAEBAAAEAAAAAQEA
AAgAAAABAQAADAAAAAEBAAAQAAAAAQEAABQAAAABAQAAGAAAAAEBAAAcAAAAAQEAACAAAAABAQAA
2AAAAAEYAAB4AQAAARYAAA==

# decode base64 locally 
base64 -d rootkitBase64 > rootkit.ko
# ps: im a dumbass (the sourcefile is litearly on th website)

# replace the syscall hook for sys_open using sed by changing the instraction so the address wont be relative to ds

			------ IDA ------	
[+] syscall hooked func address -> sys_openat = MEMORY[0xC15FA4BC];
[+] instraction in x86 asm

	In [12]: asm("mov eax, ds:0xC15FA034")
	Out[12]: b'\xa14\xa0_\xc1' -> '\xc1\x5f\xa0\x34\xa1' -> '\xa1\x34\xa0\x5f\xc1'


$  cat /proc/kallsyms  | grep sys_open
c106c7c0 W compat_sys_open_by_handle_at
c1158bc0 T do_sys_open
c1158d70 T sys_open
c1158db0 T sys_openat

[+] original sys_open func address -> 0xc1158d70
[+] therefore:

	In [13]: asm("mov eax, 0xc1158d70")
	Out[13]: b'\xb8p\x8d\x15\xc1' -> '\xc1\x15\x8d\x70\xb8' -> '\xb8\x70\x8d\x15\xc1'



sed -i 's/\xa1\x34\xa0\x5f\xc1/\xb8\x70\x8d\x15\xc1/g' rootkit.ko

# replace 'flag' with something else
sed -i 's/flag/kaki/g' rootkit.ko

# convert back to base64 and copy to host
base64 rootkit.ko
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
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAABHQ0M6IChVYnVudHUvTGluYXJvIDQuNi4zLTF1YnVudHU1KSA0LjYuMwAAR0NDOiAo
VWJ1bnR1L0xpbmFybyA0LjYuMy0xdWJ1bnR1NSkgNC42LjMAAC5zeW10YWIALnN0cnRhYgAuc2hz
dHJ0YWIALm5vdGUuZ251LmJ1aWxkLWlkAC5yZWwudGV4dAAucmVsLmluaXQudGV4dAAuZXhpdC50
ZXh0AC5yb2RhdGEuc3RyMS4xAC5yZWxfX21jb3VudF9sb2MALm1vZGluZm8AX192ZXJzaW9ucwAu
ZGF0YQAucmVsLmdudS5saW5rb25jZS50aGlzX21vZHVsZQAuYnNzAC5jb21tZW50AC5ub3RlLkdO
VS1zdGFjawAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbAAAABwAA
AAIAAAAAAAAANAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAMgAAAAEAAAAGAAAAAAAAAGAAAADQAgAA
AAAAAAAAAAAQAAAAAAAAAC4AAAAJAAAAAAAAAAAAAAAUEAAAiAEAABMAAAACAAAABAAAAAgAAAA8
AAAAAQAAAAYAAAAAAAAAMAMAAOUAAAAAAAAAAAAAAAEAAAAAAAAAOAAAAAkAAAAAAAAAAAAAAJwR
AADQAAAAEwAAAAQAAAAEAAAACAAAAEcAAAABAAAABgAAAAAAAAAVBAAABQAAAAAAAAAAAAAAAQAA
AAAAAABSAAAAAQAAADIAAAAAAAAAGgQAADMAAAAAAAAAAAAAAAEAAAABAAAAZQAAAAEAAAACAAAA
AAAAAFAEAAAkAAAAAAAAAAAAAAAEAAAAAAAAAGEAAAAJAAAAAAAAAAAAAABsEgAASAAAABMAAAAI
AAAABAAAAAgAAAByAAAAAQAAAAIAAAAAAAAAdAQAAFsAAAAAAAAAAAAAAAEAAAAAAAAAewAAAAEA
AAACAAAAAAAAAOAEAAAAAQAAAAAAAAAAAAAgAAAAAAAAAIYAAAABAAAAAwAAAAAAAADgBQAAAAAA
AAAAAAAAAAAABAAAAAAAAACQAAAAAQAAAAMAAAAAAAAA4AUAAIABAAAAAAAAAAAAACAAAAAAAAAA
jAAAAAkAAAAAAAAAAAAAALQSAAAQAAAAEwAAAA0AAAAEAAAACAAAAKoAAAAIAAAAAwAAAAAAAABg
BwAAJAAAAAAAAAAAAAAABAAAAAAAAACvAAAAAQAAADAAAAAAAAAAYAcAAFYAAAAAAAAAAAAAAAEA
AAABAAAAuAAAAAEAAAAAAAAAAAAAALYHAAAAAAAAAAAAAAAAAAABAAAAAAAAABEAAAADAAAAAAAA
AAAAAAC2BwAAyAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAyAsAAMACAAAUAAAA
FAAAAAQAAAAQAAAACQAAAAMAAAAAAAAAAAAAAIgOAACJAQAAAAAAAAAAAAABAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAIAAAAAAAAAAAAAAAAAAwAHAAEAAAAAAAAA5QAAAAIA
BAAMAAAAAAAAAAUAAAACAAYAFwAAAAAAAAAjAAAAAQAKACoAAAAjAAAACQAAAAEACgA7AAAAAAAA
AAABAAABAAsASAAAACwAAAAvAAAAAQAKAAAAAAAAAAAAAAAAAAMAAQAAAAAAAAAAAAAAAAADAAQA
AAAAAAAAAAAAAAAAAwAGAAAAAAAAAAAAAAAAAAMACAAAAAAAAAAAAAAAAAADAAoAAAAAAAAAAAAA
AAAAAwALAAAAAAAAAAAAAAAAAAMADAAAAAAAAAAAAAAAAAADAA0AAAAAAAAAAAAAAAAAAwAPAAAA
AAAAAAAAAAAAAAMAEAAAAAAAAAAAAAAAAAADABEAWAAAACAAAAAEAAAAEQAPAFwAAAAAAAAAgAEA
ABEADQBqAAAAAAAAAAUAAAASAAYAeQAAAAAAAAAEAAAAEQAPAIYAAAAAAAAA5QAAABIABACSAAAA
AAAAAE0AAAASAAIApgAAAAwAAAAEAAAAEQAPAK8AAAAcAAAABAAAABEADwC4AAAA8AEAAFQAAAAS
AAIAygAAABgAAAAEAAAAEQAPANUAAAAAAAAAAAAAABAAAADcAAAAUAIAAE0AAAASAAIA7AAAAAAA
AAAAAAAAEAAAAPMAAAAAAAAAAAAAABAAAAD6AAAAoAAAAFQAAAASAAIADAEAAKACAAAvAAAAEgAC
AA8BAAAQAAAABAAAABEADwAdAQAACAAAAAQAAAARAA8AKAEAAFAAAABGAAAAEgACADoBAACgAQAA
RgAAABIAAgBNAQAAUAEAAE0AAAASAAIAYgEAAAQAAAAEAAAAEQAPAG0BAAAAAQAARgAAABIAAgB9
AQAAFAAAAAQAAAARAA8AAGluaXRtb2R1bGUAZXhpdG1vZHVsZQBfX21vZF9zcmN2ZXJzaW9uMzIA
X19tb2R1bGVfZGVwZW5kcwBfX19fdmVyc2lvbnMAX19tb2RfdmVybWFnaWM1AHNjdABfX3RoaXNf
bW9kdWxlAGNsZWFudXBfbW9kdWxlAHN5c19yZW5hbWVhdABpbml0X21vZHVsZQBzeXNfcmVuYW1l
YXRfaG9va2VkAHN5c19saW5rAHN5c19vcGVuAHN5c19vcGVuYXRfaG9va2VkAHN5c19vcGVuYXQA
c3Ryc3RyAHN5c19vcGVuX2hvb2tlZABtY291bnQAcHJpbnRrAHN5c19saW5rYXRfaG9va2VkAHdw
AHN5c19zeW1saW5rYXQAc3lzX2xpbmthdABzeXNfcmVuYW1lX2hvb2tlZABzeXNfc3ltbGlua19o
b29rZWQAc3lzX3N5bWxpbmthdF9ob29rZWQAc3lzX3JlbmFtZQBzeXNfbGlua19ob29rZWQAc3lz
X3N5bWxpbmsAAAAACAAAAAIgAAANAAAAAQIAABcAAAACHgAAMgAAAAEXAAA/AAAAAQIAAEQAAAAC
IQAAWAAAAAIgAABdAAAAAQIAAGcAAAACHgAAewAAAAEpAACIAAAAAQIAAI0AAAACIQAAqAAAAAIg
AACtAAAAAQIAALcAAAACHgAA2QAAAAElAADmAAAAAQIAAOsAAAACIQAACAEAAAIgAAANAQAAAQIA
ABcBAAACHgAAKwEAAAEaAAA4AQAAAQIAAD0BAAACIQAAWAEAAAIgAABdAQAAAQIAAGcBAAACHgAA
ggEAAAEkAACPAQAAAQIAAJQBAAACIQAAqAEAAAIgAACtAQAAAQIAALcBAAACHgAAywEAAAErAADY
AQAAAQIAAN0BAAACIQAA+AEAAAIgAAD9AQAAAQIAAAcCAAACHgAAKQIAAAEdAAA2AgAAAQIAADsC
AAACIQAAWAIAAAIgAABdAgAAAQIAAGcCAAACHgAAggIAAAEbAACPAgAAAQIAAJQCAAACIQAApAIA
AAIgAAAKAAAAARQAABMAAAABGwAAHQAAAAEdAAAnAAAAASsAADEAAAABJAAAOwAAAAEaAABFAAAA
ASUAAE8AAAABKQAAWQAAAAEXAABgAAAAAiMAAGUAAAABFAAAbAAAAAEfAAB2AAAAARwAAIAAAAAB
JwAAigAAAAEoAACRAAAAASoAAJsAAAABIgAApQAAAAEmAACvAAAAARkAALkAAAACIwAAvgAAAAEV
AADEAAAAARUAANEAAAABFQAA1QAAAAEVAADbAAAAARUAAN8AAAABFQAAAAAAAAEBAAAEAAAAAQEA
AAgAAAABAQAADAAAAAEBAAAQAAAAAQEAABQAAAABAQAAGAAAAAEBAAAcAAAAAQEAACAAAAABAQAA
2AAAAAEYAAB4AQAAARYAAA==


---------- ON HOST -------------
$ vi b64 (paste base64 code)
$ base64 -d b64 > kaki.ko
$ insmod kaki.ko
$ cat flag
�m�U��1
�@��s�m�fv7+x;s��H��"��5�E�B��y
                               3ś~l��1-R�Kߩ���u�c2�DM��8ݺ�����9��)������Kyk���rͳ�J���t��nX�C�M(/ # 


# oh mam wtf is this -_-

# the list of commands in busybox doesnt include binwalk or something likethat
# so i checked the file firsts bytes to search the signture
$ hexdump -C flag
00000000  1f 8b 08 00 c7 6d b2 55  00 03 ed cf 31 0a c2 40  |.....m.U....1..@|
00000010  10 85 e1 a9 73 8a 6d ed  66 76 37 2b 78 05 3b 73  |....s.m.fv7+x.;s|
00000020  82 14 89 48 02 81 b8 22  de de 35 a5 45 ac 42 10  |...H..."..5.E.B.|
00000030  fe af 79 0c 33 c5 9b 7e  6c af b2 31 2d 52 8c 4b  |..y.3..~l..1-R.K|
00000040  16 df a9 1a bc 98 0f 75  b0 63 32 9f 44 4d a3 99  |.......u.c2.DM..|
00000050  38 dd ba d8 c7 e3 9e db  d9 39 99 a7 29 af dd fd  |8........9..)...|
00000060  da ff a9 4b 79 6b b8 e5  fc 72 cd b3 eb 4a 9c 97  |...Kyk...r...J..|
00000070  e1 74 a8 f6 6e 06 00 00  00 00 00 00 00 00 00 00  |.t..n...........|
00000080  00 00 00 58 f3 06 43 cc  4d 0e 00 28 00 00        |...X..C.M..(..|
0000008e

# found out its a GZIP compressed file (gz tar.gz )
# full list on wikipedia: https://en.wikipedia.org/wiki/List_of_file_signatures (very helpful tbh, binwalk does the same)
agam@agam:~/Desktop/pwnable/rootkit$ man -k gzip
gzip (1)             - compress or expand files

# decompress and submit ;)
$ cp flag flagl.gz
$ gzip -d flagl.gz
$ cat flagl
flag0000644000000000000000000000003212353176126010411 0ustar  rootrootRootkitty Sweety Kitty :)

therefore, the final flag is: Rootkitty Sweety Kitty :)



		YAYYYYYYYYYYYYYYYYYYY :D



